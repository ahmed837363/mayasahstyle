// ========================================
// ๐ Brevo Email API Configuration
// ========================================
// IMPORTANT: For security, move this to a separate config.js file that is NOT pushed to GitHub
// Add config.js to .gitignore to keep your API key safe
window.BREVO_API_KEY = ''; // Set this in config.js (see config.example.js)

// ========================================
// Language Switching - Full Translation System
// ========================================
function translatePage(lang) {
    // First handle all elements with translation spans
    document.querySelectorAll('[data-translate-ar], [data-translate-en]').forEach(span => {
        if (span.hasAttribute('data-translate-ar')) {
            span.style.display = lang === 'ar' ? 'inline' : 'none';
        }
        if (span.hasAttribute('data-translate-en')) {
            span.style.display = lang === 'en' ? 'inline' : 'none';
        }
    });

    // Then handle elements with data-translate attribute
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (!translations[lang] || !translations[lang][key]) return;
        // Skip if element contains translation spans
        if (!element.querySelector('[data-translate-ar], [data-translate-en]')) {
            // If it's a badge, preserve whitespace/formatting
            if (
                element.classList.contains('home-product-discount') ||
                element.classList.contains('product-badge') ||
                element.classList.contains('discount')
            ) {
                // Only update if the element is visible (not hidden by style)
                if (element.offsetParent !== null || element.style.display !== 'none') {
                    element.textContent = translations[lang][key];
                }
            } else {
                element.textContent = translations[lang][key];
            }
        }
    });

    // Ensure targeted product title class is updated after language switch
    const urlParams = new URLSearchParams(window.location.search);
    const id = parseInt(urlParams.get('id'));
    const product = window.productsData ? window.productsData.find(p => p.id === id) : null;
    const titleEl = document.getElementById('product-title');
    if (titleEl && product) {
        if (lang === 'en' && product.key === 'product2') {
            titleEl.classList.add('product-title-golden-embroidery-en');
        } else {
            titleEl.classList.remove('product-title-golden-embroidery-en');
        }
    }

    // Handle special elements like placeholders
    const promoInput = document.getElementById('promo-code');
    if (promoInput && translations[lang] && translations[lang]['promoCode']) {
        promoInput.setAttribute('placeholder', translations[lang]['promoCode']);
    }

    // Handle all elements with data-translate-placeholder attribute
    document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
        const key = element.getAttribute('data-translate-placeholder');
        if (translations[lang] && translations[lang][key]) {
            element.setAttribute('placeholder', translations[lang][key]);
        }
    });

    // Handle size selector
    const sizeSelect = document.getElementById('size');
    if (sizeSelect) {
        const sizeLabel = document.querySelector('label[for="size"][data-translate="size"]');
        if (sizeLabel && translations[lang] && translations[lang]['size']) {
            sizeLabel.textContent = translations[lang]['size'];
        }
        const selectOption = sizeSelect.querySelector('option[data-translate="selectSize"]');
        if (selectOption && translations[lang] && translations[lang]['selectSize']) {
            selectOption.textContent = translations[lang]['selectSize'];
        }
    }

    // Show/hide separate footers
    if (lang === 'ar') {
        document.querySelectorAll('.footer-ar').forEach(el => {
            el.style.display = 'flex';
        });
        document.querySelectorAll('.footer-en').forEach(el => {
            el.style.display = 'none';
        });
    } else {
        document.querySelectorAll('.footer-ar').forEach(el => {
            el.style.display = 'none';
        });
        document.querySelectorAll('.footer-en').forEach(el => {
            el.style.display = 'flex';
        });
    }

    // Update cookie banner language if it exists
    if (window.pdplCookieManager) {
        window.pdplCookieManager.setLanguage(lang);
    }
}

// --- Cart/Checkout/Shipping Constants (must be above all functions that use them) ---

const productsData = [
    {
        id: 1,
        images: [
            "images/product1 front.jpg", // front
            "images/product1 left.jpg", // left
            "images/product1 right.jpg", // right
            "images/product1 back.jpg" // back
        ],
        key: "product1",
        desc_ar: "ุนุจุงูุฉ ุณูุฏุงุก ุจุชุตููู ููุงุณููู ูุฌูุฏุฉ ุนุงููุฉุ ููุงุณุจุฉ ูุฌููุน ุงูููุงุณุจุงุช.",
        desc_en: "Classic black abaya with high quality, suitable for all occasions.",
        price: 199.99,
        original: 249.99,
        discount: "-15%"
    },
    {
        id: 2,
        images: [
            "images/abaya2.jpg",
            "images/abaya2_left.jpg",
            "images/abaya2_right.jpg",
            "images/abaya2_back.jpg"
        ],
        key: "product2",
        desc_ar: "ุนุจุงูุฉ ูุทุฑุฒุฉ ุจุงูุฎูุท ุงูุฐูุจู ูุฅุทูุงูุฉ ูุงุฎุฑุฉ.",
        desc_en: "Abaya embroidered with golden thread for a luxurious look.",
        price: 349.99,
        original: null,
        // CHANGE: Remove hardcoded Arabic "ุฌุฏูุฏ" and use translation key
        discount: "new"
    },
    {
        id: 3,
        images: [
            "images/abaya3.jpg",
            "images/abaya3_left.jpg",
            "images/abaya3_right.jpg",
            "images/abaya3_back.jpg"
        ],
        key: "product3",
        desc_ar: "ุนุจุงูุฉ ูุญูู ุจุชุตููู ุนุตุฑู ูุฃููู.",
        desc_en: "Modern and elegant navy abaya.",
        price: 279.99,
        original: null,
        discount: null
    },
    {
        id: 4,
        images: [
            "images/abaya4.jpg",
            "images/abaya4_left.jpg",
            "images/abaya4_right.jpg",
            "images/abaya4_back.jpg"
        ],
        key: "product4",
        desc_ar: "ุนุจุงูุฉ ุฑูุงุฏูุฉ ุจุชูุงุตูู ูุถูุฉ ุฑุงููุฉ.",
        desc_en: "Gray abaya with elegant silver details.",
        price: 249.99,
        original: null,
        discount: null
    }
];

// Make productsData available globally for updateProductDetailContent
window.productsData = productsData;

// --- Product Detail Image Carousel Logic ---
document.addEventListener('DOMContentLoaded', function() {
    // Only run on product-detail page
    if (!document.body.classList.contains('product-detail-page')) return;
    // Get product id from URL
    const urlParams = new URLSearchParams(window.location.search);
    const productId = parseInt(urlParams.get('id'));
    const product = productsData.find(p => p.id === productId);
    if (!product || !product.images) return;
    let currentImageIndex = 0;
    const productImage = document.getElementById('product-image');
    const arrowLeft = document.getElementById('arrow-left');
    const arrowRight = document.getElementById('arrow-right');
    // Helper to update image
    function updateImage() {
        productImage.src = product.images[currentImageIndex];
        // Optionally, update alt text for accessibility
        const sides = ['front', 'left', 'right', 'back'];
        productImage.alt = productImage.alt = `${product.key} ${sides[currentImageIndex] || ''}`;
    }
    // Initial image
    updateImage();
    // Arrow click handlers
    arrowLeft.addEventListener('click', function() {
        currentImageIndex = (currentImageIndex - 1 + product.images.length) % product.images.length;
        updateImage();
    });
    arrowRight.addEventListener('click', function() {
        currentImageIndex = (currentImageIndex + 1) % product.images.length;
        updateImage();
    });
});

const translations = {
    ar: {
        product1: "ุนุจุงูุฉ ุณูุฏุงุก ููุงุณูููุฉ",
        product2: "ุนุจุงูุฉ ูุทุฑุฒุฉ ุจุงูุฎูุท ุงูุฐูุจู",
        product3: "ุนุจุงูุฉ ูุญูู ุจุชุตููู ุนุตุฑู",
        product4: "ุนุจุงูุฉ ุฑูุงุฏูุฉ ุจุชูุงุตูู ูุถูุฉ",
        size: "ุงูููุงุณ",
        selectSize: "ุงุฎุชุฑ ุงูููุงุณ",
        addToCart: "ุฃุถู ููุณูุฉ",
        storeName: "ููุงุณู ุณุชูู",
        home: "ุงูุฑุฆูุณูุฉ",
        products: "ุงูููุชุฌุงุช",
        cart: "ุนุฑุจุฉ ุงูุชุณูู",
        contact: "ุงุชุตู ุจูุง",
        aboutStore: "ุนู ุงููุชุฌุฑ",
        aboutText: "ูุชุฌุฑ ููุงุณู ุณุชูู ููุฏู ุฃุญุฏุซ ุชุตุงููู ุงูุนุจุงุกุงุช ููุณูุฏุงุช ุงููุชููุฒุงุช ูู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ. ููุฏู ุฌูุฏุฉ ุนุงููุฉ ูุชุตุงููู ุฃูููุฉ ุชูุงุณุจ ุฌููุน ุงูุฃุฐูุงู.",
        quickLinks: "ุฑูุงุจุท ุณุฑูุนุฉ",
        contactInfo: "ูุนูููุงุช ุงูุชูุงุตู",
        contactLocation: "ุฌุฏุฉุ ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ",
        copyright: "ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2023 ููุงุณู ุณุชูู | ุชู ุชุทููุฑู ุจุญุจ ูู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ",
        new: "ุฌุฏูุฏ",
        discount15: "ุฎุตู 15%",
        discount10: "ุฎุตู 10%",
        emptyCart: "ุณูุฉ ุงูุชุณูู ูุงุฑุบุฉ",
        promoCode: "ุฃุฏุฎู ุฑูุฒ ุงูุฎุตู",
        checkout: "ุฅุชูุงู ุงูุดุฑุงุก",
        remove: "ุฅุฒุงูุฉ",
        sizeLabel: "ุงูููุงุณ",
        subtotal: "ุงููุฌููุน ุงููุฑุนู",
        vat: "ุถุฑูุจุฉ ุงููููุฉ ุงููุถุงูุฉ",
        shipping: "ุงูุดุญู",
        total: "ุงูุฅุฌูุงูู",
        freeShipping: "!ูุจุฑูู! ุงูุดุญู ูุฌุงูู ููุฐุง ุงูุทูุจ",
        addMoreForFreeShipping: "ุฃุถู ููุชุฌุงุช ุจูููุฉ {amount} ุฃุฎุฑู ูุชุญุตู ุนูู ุดุญู ูุฌุงูู",
        checkoutSubtitle: "ุฃููู ุทูุจู ุจุงุชุจุงุน ุงูุฎุทูุงุช ุงูุชุงููุฉ",
        shippingInfoDesc: "ุฃุฏุฎู ูุนูููุงุช ุงูุชูุตูู ุงูุฎุงุตุฉ ุจู",
        orderNotes: "ููุงุญุธุงุช ุงูุทูุจ",
        items: "ุงูููุชุฌุงุช",
        quantity: "ุงููููุฉ",
        estimatedDelivery: "ุงูุชูุตูู ุงููุชููุน ุฎูุงู 3-5 ุฃูุงู ุนูู",
        orderNote: "ุณูุชู ุฅุฑุณุงู ุชูุงุตูู ุงูุทูุจ ูุงูููุงุชูุฑ ุฅูู ุจุฑูุฏู ุงูุฅููุชุฑููู",
        selectCity: "ุงุฎุชุฑ ุงููุฏููุฉ",
        congratulations: "!ูุจุฑูู! ุงูุดุญู ูุฌุงูู ููุฐุง ุงูุทูุจ",
        orderSummary: "ููุฎุต ุงูุทูุจ",
        confirmOrder: "ุชุฃููุฏ ุงูุทูุจ",
        contactPhone: "+966 50 123 4567",
        contactEmail: "mayasahstyle@gmail.com",
        instagram: "ุงูุณุชูุฑุงู",
        twitter: "ุชููุชุฑ",
        snapchat: "ุณูุงุจ ุดุงุช",
        tiktok: "ุชูู ุชูู",
        heroTitle: "ุนุจุงูุงุช ูุงุฎุฑุฉ ุจุชุตุงููู ุนุตุฑูุฉ",
        heroDesc: "ุชุณููู ุฃุญุฏุซ ุชุดูููุงุช ุงูุนุจุงูุงุช ุงููุงุฎุฑุฉ ุจุฌูุฏุฉ ุนุงููุฉ ูุชุตุงููู ุชูุงุณุจ ุฌููุน ุงูุฃุฐูุงู. ุชูุตูู ุณุฑูุน ูุฌููุน ูุฏู ุงูููููุฉ.",
        heroSubtitle: "ุงูุชุดู ุฃุญุฏุซ ุชุดูููุงุช ุงูุนุจุงุกุงุช ุงููุตููุฉ ุจุนูุงูุฉ ูุชูุงุณุจ ุฐููู ุงูุฑููุน",
        heroBtn: "ุชุณููู ุงูุขู",
        browseCollection: "ุชุตูุญ ุงููุฌููุนุฉ",
        whyChooseUs: "ููุงุฐุง ุชุฎุชุงุฑ ูุชุฌุฑูุง",
        shippingInfo: "ูุนูููุงุช ุงูุดุญู",
        fullName: "ุงูุงุณู ุงููุงูู",
        email: "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู",
        phone: "ุฑูู ุงูุฌูุงู",
        address: "ุงูุนููุงู",
        city: "ุงููุฏููุฉ",
        zip: "ุงูุฑูุฒ ุงูุจุฑูุฏู",
        paymentMethod: "ุทุฑู ุงูุฏูุน",
        apply: "ุชุทุจูู",
        orderConfirmed: "ุชู ุชุฃููุฏ ุทูุจู ุจูุฌุงุญ!",
        thankYou: "ุดูุฑุงู ูุดุฑุงุฆู ูู ููุงุณู ุณุชูู. ููุฏ ุชู ุงุณุชูุงู ุทูุจู ุจูุฌุงุญ ูุณูุชู ุชุฌููุฒู ููุดุญู ูู ุฃูุฑุจ ููุช ูููู. ุณูู ุชุชููู ุจุฑูุฏุงู ุฅููุชุฑูููุงู ุจุชูุงุตูู ุงูุทูุจ ูุชุชุจุน ุงูุดุญู ุจูุฌุฑุฏ ุดุญู ุทูุจู.",
        orderNumber: "ุฑูู ุงูุทูุจ:",
        orderDate: "ุชุงุฑูุฎ ุงูุทูุจ:",
        totalAmount: "ุงููุฌููุน ุงูููู:",
        shippingAddress: "ุนููุงู ุงูุดุญู:",
        trackingNumber: "ุฑูู ุงูุชุชุจุน:",
        continueShopping: "ุงุณุชูุฑ ูู ุงูุชุณูู",
        whyUs: "ููุงุฐุง ูุญูุ",
        featuredProducts: "ุฃูุถู ุงูููุชุฌุงุช",
        feature1Title: "ุฌูุฏุฉ ุนุงููุฉ",
        feature1Desc: "ูุณุชุฎุฏู ุฃูุถู ุงูุฎุงูุงุช ูุงูุชุทุฑูุฒุงุช ูุถูุงู ุงูุฌูุฏุฉ.",
        feature2Title: "ุชูุตูู ุณุฑูุน",
        feature2Desc: "ุดุญู ุณุฑูุน ูุขูู ูุฌููุน ููุงุทู ุงูููููุฉ.",
        feature3Title: "ุฏุนู ุนููุงุก 24/7",
        feature3Desc: "ูุฑูู ุฏุนู ูุชูุงุฌุฏ ุฏุงุฆูุงู ูุฎุฏูุชู.",
        new: "ุฌุฏูุฏ",
        useMyLocation: "ุงุณุชุฎุฏู ูููุนู",
        detectingLocation: "ุฌุงุฑู ุชุญุฏูุฏ ุงููููุน...",
        locationDetected: "ุชู ุชุญุฏูุฏ ุงููููุน ุจูุฌุงุญ!",
        cityDetectedNoStreet: "ุชู ุชุญุฏูุฏ ุงููุฏููุฉ ูููู ูู ูุชู ุงูุนุซูุฑ ุนูู ุงุณู ุงูุดุงุฑุน. ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงูุดุงุฑุน ูุฏููุงู.",
        locationAccessDenied: "ุชู ุฑูุถ ุงููุตูู ูููููุน. ูุฑุฌู ุงูุณูุงุญ ุจุงููุตูู ูููููุน ุฃู ุงูุฅุฏุฎุงู ูุฏููุงู.",
        locationUnavailable: "ูุนูููุงุช ุงููููุน ุบูุฑ ูุชููุฑุฉ.",
        locationTimeout: "ุงูุชูุช ูููุฉ ุทูุจ ุงููููุน.",
        couldNotGetAddress: "ุชุนุฐุฑ ุงูุญุตูู ุนูู ุงูุนููุงู ูู ุงูุฅุญุฏุงุซูุงุช.",
        errorGettingAddress: "ุฎุทุฃ ูู ุงูุญุตูู ุนูู ุงูุนููุงู: ",
        emailInvoice: "ูุงุชูุฑุฉ ุจุฑูุฏ ุฅููุชุฑููู",
        chatWithBot: "ุชุญุฏุซ ูุน ุงููุณุงุนุฏ ุงูุฐูู",
        mayasahAssistant: "ูุณุงุนุฏ ููุงุณู ุงูุฐูู",
        online: "ูุชุตู ุงูุขู",
        welcomeMessage: "ูุฑุญุจุงู! ุฃูุง ูุณุงุนุฏ ููุงุณู ุงูุฐูู. ููู ูููููู ูุณุงุนุฏุชู ุงููููุ",
        askProducts: "ุงูููุชุฌุงุช ุงููุชููุฑุฉ",
        askShipping: "ูุนูููุงุช ุงูุดุญู",
        // Payment translations
        paymentInfo: "ูุนูููุงุช ุงูุฏูุน",
        paymentInfoDesc: "ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน ุงูููุถูุฉ ูุฏูู",
        madaCard: "ุจุทุงูุฉ ูุฏู",
        madaDesc: "ุจุทุงูุฉ ูุฏู ุงูุงุฆุชูุงููุฉ ุฃู ุงููุฏู ุงููุจุงุดุฑ",
        visaCard: "ููุฒุง / ูุงุณุชุฑูุงุฑุฏ",
        visaDesc: "ุจุทุงูุงุช ููุฒุง ููุงุณุชุฑูุงุฑุฏ ุงูุฏูููุฉ",
        applePay: "Apple Pay",
        applePayDesc: "ุงูุฏูุน ุนุจุฑ Apple Pay",
        stcPay: "STC Pay",
        stcPayDesc: "ุงูุฏูุน ุนุจุฑ ุชุทุจูู STC Pay",
        cashOnDelivery: "ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู",
        codDesc: "ุงุฏูุน ููุฏุงู ุนูุฏ ุงุณุชูุงู ุงูุทูุจ",
        cardNumber: "ุฑูู ุงูุจุทุงูุฉ",
        cardHolder: "ุงุณู ุญุงูู ุงูุจุทุงูุฉ",
        expiryDate: "ุชุงุฑูุฎ ุงูุงูุชูุงุก",
        cvv: "ุฑูุฒ ุงูุฃูุงู",
        paymentSecurity: "ุฌููุน ุงููุฏููุนุงุช ูุญููุฉ ููุดูุฑุฉ. ูู ูุดุงุฑู ุจูุงูุงุชู ูุน ุฃู ุทุฑู ุซุงูุซ.",
        payNow: "ุงุฏูุน ุงูุขู",
        transactionId: "ุฑูู ุงููุนุงููุฉ",
        askSizes: "ุงูููุงุณุงุช ุงููุชููุฑุฉ",
        askContact: "ุงูุชูุงุตู ุงููุจุงุดุฑ",
        typeMessage: "ุงูุชุจ ุฑุณุงูุชู ููุง...",
        sendMessage: "ุฃุฑุณู ููุง ุฑุณุงูุฉ",
        subject: "ุงูููุถูุน",
        selectSubject: "ุงุฎุชุฑ ุงูููุถูุน",
        generalInquiry: "ุงุณุชูุณุงุฑ ุนุงู",
        orderInquiry: "ุงุณุชูุณุงุฑ ุนู ุงูุทูุจ",
        productInquiry: "ุงุณุชูุณุงุฑ ุนู ุงูููุชุฌ",
        complaint: "ุดููู",
        suggestion: "ุงูุชุฑุงุญ",
        typeYourMessage: "ุงูุชุจ ุฑุณุงูุชู ููุง...",
        contactWhatsapp: "ุชูุงุตู ุนุจุฑ ูุงุชุณุงุจ",
        workingHours: "ุณุงุนุงุช ุงูุนูู",
        message: "ุงูุฑุณุงูุฉ",
        workingHoursText: "9 ุตุจุงุญุงู - 10 ูุณุงุกู",
        name: "ุงูุงุณู",
        phoneOptional: "ุฑูู ุงููุงุชู (ุงุฎุชูุงุฑู)",
        aboutUs: "ูู ูุญู",
        aboutUsTitle: "ููุงุณู ุณุชูู - ุฑุญูุฉ ูู ุงูุฃูุงูุฉ ูุงูุชููุฒ",
        aboutUsIntro: "ูุฑุญุจุงู ุจูู ูู ููุงุณู ุณุชููุ ูุฌูุชูู ุงููุซุงููุฉ ูุฃุญุฏุซ ูุฃุฌูู ุชุดูููุงุช ุงูุนุจุงุกุงุช ุงููุณุงุฆูุฉ. ูุญู ูุชุฌุฑ ูุชุฎุตุต ูู ุชูุฏูู ุฃูุถู ุฃููุงุน ุงูุนุจุงุกุงุช ุงูุชู ุชุฌูุน ุจูู ุงูุฃูุงูุฉ ุงูุนุตุฑูุฉ ูุงูุฃุตุงูุฉ ุงูุชุฑุงุซูุฉ.",
        aboutUsMission: "ููุฐ ุชุฃุณูุณูุงุ ูุงู ูุฏููุง ุงูุฃุณุงุณู ูู ุชูุฏูู ูุทุน ูุฑูุฏุฉ ุชุนูุณ ุฌูุงู ูุฃูุงูุฉ ุงููุฑุฃุฉ ุงูุนุฑุจูุฉ. ูุฎุชุงุฑ ุจุนูุงูุฉ ูุงุฆูุฉ ูู ูุทุนุฉ ูู ูุฌููุนุชูุง ูุถูุงู ุงูุฌูุฏุฉ ุงูุนุงููุฉ ูุงูุชุตููู ุงููุชููุฒ.",
        aboutUsCollection: "ููุชุฎุฑ ุจุชูุฏูู ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุนุจุงุกุงุช ุงูุชู ุชูุงุณุจ ุฌููุน ุงูููุงุณุจุงุชุ ูู ุงูุนุจุงุกุงุช ุงูููููุฉ ุงูุจุณูุทุฉ ุฅูู ุงููุทุน ุงููุทุฑุฒุฉ ุงููุงุฎุฑุฉ ููููุงุณุจุงุช ุงูุฎุงุตุฉ.",
        highQuality: "ุงูุฌูุฏุฉ ุงูุนุงููุฉ",
        highQualityDesc: "ูุฎุชุงุฑ ุฃูุถู ุงูุฎุงูุงุช ูุงูุฃููุดุฉ ูุถูุงู ุงูุฑุงุญุฉ ูุงูุฃูุงูุฉ",
        passionForExcellence: "ุดุบู ุจุงูุชููุฒ",
        passionForExcellenceDesc: "ูุนูู ุจุดุบู ูุชูุฏูู ุฃูุถู ุชุฌุฑุจุฉ ุชุณูู ูุนููุงุฆูุง ุงููุฑุงู",
        customerService: "ุฎุฏูุฉ ุงูุนููุงุก",
        customerServiceDesc: "ูุฑูู ุฏุนู ูุชุฎุตุต ูุชูุงุฌุฏ ุฏุงุฆูุงู ูุฎุฏูุชูู ููุณุงุนุฏุชูู",
        ourMission: "ุฑุณุงูุชูุง",
        missionStatement: "ูุณุนู ููููู ุงูุฎูุงุฑ ุงูุฃูู ูููุฑุฃุฉ ุงูุนุฑุจูุฉ ูู ุนุงูู ุงูุฃุฒูุงุกุ ูู ุฎูุงู ุชูุฏูู ุนุจุงุกุงุช ุชุฌูุน ุจูู ุงูุฃูุงูุฉ ูุงูุฌูุฏุฉ ูุงูุฑุงุญุฉุ ูุน ุงูุญูุงุธ ุนูู ุงูููู ุงูุฃุตููุฉ ูุงูุชุทูุน ูุญู ุงููุณุชูุจู",
        termsConditions: "ุงูุดุฑูุท ูุงูุฃุญูุงู",
        lastUpdated: "ุขุฎุฑ ุชุญุฏูุซ: ููุงูุฑ 2025",
        termsAcceptance: "ูุจูู ุงูุดุฑูุท",
        termsAcceptanceText: "ุจุงุณุชุฎุฏุงู ูููุน ููุงุณู ุณุชูู ุงูุฅููุชุฑูููุ ูุฅูู ุชูุงูู ุนูู ุงูุงูุชุฒุงู ุจูุฐู ุงูุดุฑูุท ูุงูุฃุญูุงู. ุฅุฐุง ููุช ูุง ุชูุงูู ุนูู ุฃู ุฌุฒุก ูู ูุฐู ุงูุดุฑูุทุ ูุฑุฌู ุนุฏู ุงุณุชุฎุฏุงู ูููุนูุง.",
        useLicense: "ุชุฑุฎูุต ุงูุงุณุชุฎุฏุงู",
        useLicenseText: "ูุชู ููุญ ุชุฑุฎูุต ูุคูุช ูููุตูู ุฅูู ุงูููุงุฏ ุงูููุฌูุฏุฉ ุนูู ูููุน ููุงุณู ุณุชูู ููุงุณุชุฎุฏุงู ุงูุดุฎุตู ุบูุฑ ุงูุชุฌุงุฑู ููุท. ูุฐุง ุงูุชุฑุฎูุต ูุง ูุดูู:",
        licenseRestriction1: "ุชุนุฏูู ุฃู ูุณุฎ ุงูููุงุฏ",
        licenseRestriction2: "ุงุณุชุฎุฏุงู ุงูููุงุฏ ูุฃุบุฑุงุถ ุชุฌุงุฑูุฉ",
        licenseRestriction3: "ูุญุงููุฉ ุนูุณ ููุฏุณุฉ ุฃู ุจุฑูุงูุฌ ุนูู ูููุน ููุงุณู ุณุชูู",
        licenseRestriction4: "ุฅุฒุงูุฉ ุฃู ุญููู ูุดุฑ ุฃู ุฅุดุนุงุฑุงุช ุงูููููุฉ",
        productInformation: "ูุนูููุงุช ุงูููุชุฌุงุช",
        productInformationText: "ูุณุนู ุฌุงูุฏูู ูุถูุงู ุฏูุฉ ุฌููุน ุงููุนูููุงุช ุงููุชุนููุฉ ุจุงูููุชุฌุงุชุ ุจูุง ูู ุฐูู ุงูุฃูุตุงู ูุงูุฃุณุนุงุฑ ูุงูุตูุฑ. ููุน ุฐููุ ูุง ูุถูู ุฃู ุงููุนูููุงุช ุฏูููุฉ ุฃู ูุงููุฉ ุฃู ูุญุฏุซุฉ.",
        pricingAndPayment: "ุงูุฃุณุนุงุฑ ูุงูุฏูุน",
        pricingAndPaymentText: "ุฌููุน ุงูุฃุณุนุงุฑ ุจุงูุฑูุงู ุงูุณุนูุฏู ูุชุดูู ุถุฑูุจุฉ ุงููููุฉ ุงููุถุงูุฉ. ูุญุชูุธ ุจุงูุญู ูู ุชุบููุฑ ุงูุฃุณุนุงุฑ ูู ุฃู ููุช ุฏูู ุฅุดุนุงุฑ ูุณุจู. ูุฌุจ ุฏูุน ุฌููุน ุงููุจุงูุบ ุจุงููุงูู ุนูุฏ ุงูุทูุจ.",
        shippingAndDelivery: "ุงูุดุญู ูุงูุชูุตูู",
        shippingAndDeliveryText: "ูููู ุจุงูุชูุตูู ุฅูู ุฌููุน ูุฏู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ. ููุช ุงูุชูุตูู ุงููุชููุน ูู 3-5 ุฃูุงู ุนูู. ูุฏ ุชุชุฃุฎุฑ ุฃููุงุช ุงูุชูุตูู ูู ุงูููุงุณุจุงุช ุงูุฎุงุตุฉ ุฃู ุงูุธุฑูู ุงูุงุณุชุซูุงุฆูุฉ.",
        returnsAndRefunds: "ุงูุฅุฑุฌุงุน ูุงูุงุณุชุฑุฏุงุฏ",
        returnsAndRefundsText: "ูููู ุฅุฑุฌุงุน ุงูููุชุฌุงุช ุฎูุงู 14 ูููุงู ูู ุชุงุฑูุฎ ุงูุงุณุชูุงู ุจุดุฑุท ุฃู ุชููู ุจุญุงูุฉ ููุชุงุฒุฉ ูุบูุฑ ูุณุชุฎุฏูุฉ. ุณูุชู ุฎุตู ุฑุณูู ุงูุดุญู ูู ูุจูุบ ุงูุงุณุชุฑุฏุงุฏ.",
        privacyAndData: "ุงูุฎุตูุตูุฉ ูุญูุงูุฉ ุงูุจูุงูุงุช",
        privacyAndDataText: "ูุญู ููุชุฒู ุจุญูุงูุฉ ุฎุตูุตูุชู. ูุชู ุฌูุน ูุงุณุชุฎุฏุงู ูุนูููุงุชู ุงูุดุฎุตูุฉ ูููุงู ูุณูุงุณุฉ ุงูุฎุตูุตูุฉ ุงูุฎุงุตุฉ ุจูุง. ุจุงุณุชุฎุฏุงู ูููุนูุงุ ูุฅูู ุชูุงูู ุนูู ุฌูุน ูุงุณุชุฎุฏุงู ูุฐู ุงููุนูููุงุช.",
        intellectualProperty: "ุงูููููุฉ ุงูููุฑูุฉ",
        intellectualPropertyText: "ุฌููุน ุงููุญุชููุงุช ุงูููุฌูุฏุฉ ุนูู ูููุน ููุงุณู ุณุชููุ ุจูุง ูู ุฐูู ุงููุตูุต ูุงูุตูุฑ ูุงูุชุตุงูููุ ูุญููุฉ ุจููุฌุจ ููุงููู ุญููู ุงููุดุฑ ูุงูููููุฉ ุงูููุฑูุฉ.",
        limitationOfLiability: "ุญุฏูุฏ ุงููุณุคูููุฉ",
        limitationOfLiabilityText: "ูู ุชููู ููุงุณู ุณุชูู ูุณุคููุฉ ุนู ุฃู ุฃุถุฑุงุฑ ูุจุงุดุฑุฉ ุฃู ุบูุฑ ูุจุงุดุฑุฉ ุฃู ุนุฑุถูุฉ ุฃู ุฎุงุตุฉ ุชูุดุฃ ุนู ุงุณุชุฎุฏุงู ูููุนูุง ุฃู ุงูููุชุฌุงุช.",
        governingLaw: "ุงููุงููู ุงููุทุจู",
        governingLawText: "ุชุฎุถุน ูุฐู ุงูุดุฑูุท ูุงูุฃุญูุงู ูููุงููู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ. ุฃู ูุฒุงุนุงุช ุชูุดุฃ ุนู ูุฐู ุงูุดุฑูุท ุณุชุฎุถุน ููุงุฎุชุตุงุต ุงูุญุตุฑู ููุญุงูู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ.",
        changesToTerms: "ุชุบููุฑุงุช ุงูุดุฑูุท",
        changesToTermsText: "ูุญุชูุธ ุจุงูุญู ูู ุชุนุฏูู ูุฐู ุงูุดุฑูุท ูุงูุฃุญูุงู ูู ุฃู ููุช. ุณูุชู ูุดุฑ ุงูุชุบููุฑุงุช ุนูู ูุฐู ุงูุตูุญุฉุ ูุณูุณุชูุฑ ุงุณุชุฎุฏุงูู ูููููุน ุจุนุฏ ุงูุชุบููุฑุงุช ูู ุงูุชุนุฏููุงุช.",
        contactInformation: "ูุนูููุงุช ุงูุชูุงุตู",
        contactInformationText: "ุฅุฐุง ูุงู ูุฏูู ุฃู ุฃุณุฆูุฉ ุญูู ูุฐู ุงูุดุฑูุท ูุงูุฃุญูุงูุ ูุฑุฌู ุงูุชูุงุตู ูุนูุง ุนุจุฑ:",
        contactAddress: "ุงูุนููุงู: ุฌุฏุฉุ ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ",
        privacyPolicy: "ุณูุงุณุฉ ุงูุฎุตูุตูุฉ",
        privacyCommitment: "ุงูุชุฒุงููุง ุจุงูุฎุตูุตูุฉ",
        privacyCommitmentText: "ูุญู ูู ููุงุณู ุณุชูู ููุชุฒู ุจุญูุงูุฉ ุฎุตูุตูุชู ูุจูุงูุงุชู ุงูุดุฎุตูุฉ. ูุฐู ุงูุณูุงุณุฉ ุชูุถุญ ููููุฉ ุฌูุน ูุงุณุชุฎุฏุงู ูุญูุงูุฉ ูุนูููุงุชู ุนูุฏ ุงุณุชุฎุฏุงู ูููุนูุง ุงูุฅููุชุฑููู.",
        informationWeCollect: "ุงููุนูููุงุช ุงูุชู ูุฌูุนูุง",
        informationWeCollectText: "ูููู ุจุฌูุน ุงููุนูููุงุช ุงูุชุงููุฉ:",
        personalInfo: "ุงููุนูููุงุช ุงูุดุฎุตูุฉ (ุงูุงุณูุ ุงูุจุฑูุฏ ุงูุฅููุชุฑูููุ ุฑูู ุงููุงุชู)",
        shippingInfo: "ูุนูููุงุช ุงูุดุญู ูุงูุนููุงู",
        paymentInfo: "ูุนูููุงุช ุงูุฏูุน (ูุง ูุฎุฒู ุจูุงูุงุช ุงูุจุทุงูุฉ)",
        orderHistory: "ุชุงุฑูุฎ ุงูุทูุจุงุช ูุงูููุชุฌุงุช ุงููุดุชุฑุงุฉ",
        websiteUsage: "ุจูุงูุงุช ุงุณุชุฎุฏุงู ุงููููุน ูุงูุชูุงุนู",
        howWeUseInfo: "ููููุฉ ุงุณุชุฎุฏุงู ุงููุนูููุงุช",
        howWeUseInfoText: "ูุณุชุฎุฏู ูุนูููุงุชู ููุฃุบุฑุงุถ ุงูุชุงููุฉ:",
        usePurpose1: "ูุนุงูุฌุฉ ุงูุทูุจุงุช ูุฅุชูุงู ุงููุจูุนุงุช",
        usePurpose2: "ุงูุชูุงุตู ูุนู ุจุฎุตูุต ุทูุจุงุชู",
        usePurpose3: "ุชุญุณูู ุฎุฏูุงุชูุง ูุชุฌุฑุจุฉ ุงููุณุชุฎุฏู",
        usePurpose4: "ุฅุฑุณุงู ุนุฑูุถ ุฎุงุตุฉ ูุชุญุฏูุซุงุช (ุจููุงููุชู)",
        usePurpose5: "ุงูุงูุชุซุงู ููููุงููู ูุงูููุงุฆุญ ุงููุนููู ุจูุง",
        informationSharing: "ูุดุงุฑูุฉ ุงููุนูููุงุช",
        informationSharingText: "ูุง ูุจูุน ุฃู ูุคุฌุฑ ุฃู ูุดุงุฑู ูุนูููุงุชู ุงูุดุฎุตูุฉ ูุน ุฃุทุฑุงู ุซุงูุซุฉ ุฅูุง ูู ุงูุญุงูุงุช ุงูุชุงููุฉ:",
        sharingCase1: "ูุน ุดุฑูุงุช ุงูุดุญู ูุชูุตูู ุทูุจุงุชู",
        sharingCase2: "ูุน ูุฒูุฏู ุฎุฏูุงุช ุงูุฏูุน ููุนุงูุฌุฉ ุงููุฏููุนุงุช",
        sharingCase3: "ุนูุฏูุง ููุชุถู ุงููุงููู ุฐูู",
        sharingCase4: "ุจููุงููุชู ุงูุตุฑูุญุฉ",
        dataSecurity: "ุฃูุงู ุงูุจูุงูุงุช",
        dataSecurityText: "ูุชุฎุฐ ุฅุฌุฑุงุกุงุช ุฃูููุฉ ููุงุณุจุฉ ูุญูุงูุฉ ูุนูููุงุชู ุงูุดุฎุตูุฉ ูู ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู ุฃู ุงูุงุณุชุฎุฏุงู ุฃู ุงููุดู ุฃู ุงูุชุนุฏูู ุฃู ุงูุชุฏููุฑ. ูุณุชุฎุฏู ุชูููุงุช ุงูุชุดููุฑ ูุงูุฌุฏุฑุงู ุงููุงุฑูุฉ ูุญูุงูุฉ ุจูุงูุงุชู.",
        cookies: "ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท (Cookies)",
        cookiesText: "ูุณุชุฎุฏู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ูุชุญุณูู ุชุฌุฑุจุชู ุนูู ูููุนูุง. ูุฐู ุงููููุงุช ุชุณุงุนุฏูุง ูู ุชุฐูุฑ ุชูุถููุงุชู ูุชูุฏูู ูุญุชูู ูุฎุตุต. ููููู ุฅุฏุงุฑุฉ ุฅุนุฏุงุฏุงุช ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ูู ูุชุตูุญู.",
        yourRights: "ุญูููู",
        yourRightsText: "ูุฏูู ุงูุญู ูู:",
        right1: "ุงููุตูู ุฅูู ูุนูููุงุชู ุงูุดุฎุตูุฉ",
        right2: "ุชุตุญูุญ ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ",
        right3: "ุญุฐู ูุนูููุงุชู ุงูุดุฎุตูุฉ",
        right4: "ุงูุงูุณุญุงุจ ูู ุงูุฑุณุงุฆู ุงูุชุณููููุฉ",
        right5: "ุชูุฏูู ุดููู ุฅูู ุงูุณูุทุงุช ุงููุฎุชุตุฉ",
        dataRetention: "ุงุญุชูุงุธ ุงูุจูุงูุงุช",
        dataRetentionText: "ูุญุชูุธ ุจูุนูููุงุชู ุงูุดุฎุตูุฉ ุทุงููุง ูุงูุช ุถุฑูุฑูุฉ ูุชูุฏูู ุฎุฏูุงุชูุง ุฃู ููุงูุชุซุงู ููุงูุชุฒุงูุงุช ุงููุงููููุฉ. ุนูุฏ ุนุฏู ุงูุญุงุฌุฉ ุฅูู ูุฐู ุงููุนูููุงุชุ ูููู ุจุญุฐููุง ุจุดูู ุขูู.",
        childrenPrivacy: "ุฎุตูุตูุฉ ุงูุฃุทูุงู",
        childrenPrivacyText: "ูุง ูุฌูุน ุนูุฏุงู ูุนูููุงุช ุดุฎุตูุฉ ูู ุงูุฃุทูุงู ุฏูู ุณู 13 ุนุงูุงู. ุฅุฐุง ููุช ุฃุญุฏ ุงููุงูุฏูู ุฃู ุงููุตู ูุชุนุชูุฏ ุฃู ุทููู ูุฏ ุฒูุฏูุง ุจูุนูููุงุช ุดุฎุตูุฉุ ูุฑุฌู ุงูุชูุงุตู ูุนูุง ููุฑุงู.",
        internationalTransfers: "ุงูุชุญูููุงุช ุงูุฏูููุฉ",
        internationalTransfersText: "ูุฏ ูุชู ููู ูุนูููุงุชู ุฅูู ุฏูู ุฃุฎุฑู ููุนุงูุฌุฉ ุงูุทูุจุงุช ุฃู ูุชูุฏูู ุงูุฎุฏูุงุช. ูุชุฃูุฏ ูู ุฃู ูุฐู ุงูุชุญูููุงุช ุชุชู ูููุงู ููููุงููู ุงููุนููู ุจูุง ูุจุฅุฌุฑุงุกุงุช ุฃูููุฉ ููุงุณุจุฉ.",
        policyChanges: "ุชุบููุฑุงุช ุงูุณูุงุณุฉ",
        policyChangesText: "ูุฏ ูููู ุจุชุญุฏูุซ ูุฐู ุงูุณูุงุณุฉ ูู ููุช ูุขุฎุฑ. ุณูููู ุจุฅุดุนุงุฑู ุจุฃู ุชุบููุฑุงุช ุฌููุฑูุฉ ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูู ุฎูุงู ุฅุดุนุงุฑ ุนูู ูููุนูุง. ูุฑุฌู ูุฑุงุฌุนุฉ ูุฐู ุงูุณูุงุณุฉ ุจุงูุชุธุงู.",
        contactUs: "ุชูุงุตู ูุนูุง",
        contactUsText: "ุฅุฐุง ูุงู ูุฏูู ุฃู ุฃุณุฆูุฉ ุญูู ุณูุงุณุฉ ุงูุฎุตูุตูุฉ ูุฐู ุฃู ููุงุฑุณุงุชูุง ูู ุงูุชุนุงูู ูุน ุงูุจูุงูุงุชุ ูุฑุฌู ุงูุชูุงุตู ูุนูุง ุนุจุฑ:"
    },
    en: {
        product1: "Classic Black Abaya",
        product2: "Abaya with Golden Embroidery",
        product3: "Modern Navy Abaya",
        product4: "Gray Abaya with Silver Details",
        new: "New",
        size: "Size",
        selectSize: "Select Size",
        addToCart: "Add to Cart",
        storeName: "Mayasah Style",
        home: "Home",
        products: "Products",
        cart: "Cart",
        contact: "Contact Us",
        aboutStore: "About the Store",
        aboutText: "Mayasah Style offers the latest abaya designs for distinguished ladies in Saudi Arabia. We provide high quality and elegant designs for all tastes.",
        quickLinks: "Quick Links",
        contactInfo: "Contact Information",
        contactLocation: "Jeddah, Saudi Arabia",
        copyright: "All rights reserved ยฉ 2023 Mayasah Style | Developed with love in Saudi Arabia",
        new: "New",
        discount15: "15% Off",
        discount10: "10% Off",
        emptyCart: "Your cart is empty",
        promoCode: "Enter promo code",
        checkout: "Checkout",
        remove: "Remove",
        sizeLabel: "Size",
        subtotal: "Subtotal",
        vat: "VAT",
        shipping: "Shipping",
        total: "Total",
        freeShipping: "Congratulations! Free shipping for this order!",
        addMoreForFreeShipping: "Add {amount} SAR more to get free shipping",
        checkoutSubtitle: "Complete your order by following these steps",
        shippingInfoDesc: "Enter your shipping information",
        orderNotes: "Order Notes",
        items: "Items",
        quantity: "Quantity",
        estimatedDelivery: "Estimated delivery within 3-5 business days",
        orderNote: "Order details and invoices will be sent to your email",
        selectCity: "Select City",
        congratulations: "Congratulations! Free shipping for this order!",
        orderSummary: "Order Summary",
        confirmOrder: "Confirm Order",
        contactPhone: "+966 50 123 4567",
        contactEmail: "mayasahstyle@gmail.com",
        instagram: "Instagram",
        twitter: "Twitter",
        snapchat: "Snapchat",
        tiktok: "TikTok",
        heroTitle: "Luxury Abayas with Modern Designs",
        heroDesc: "Shop the latest luxury abaya collections with high quality and designs for every taste. Fast delivery to all Saudi cities.",
        heroSubtitle: "Discover the latest abaya collections, carefully designed to suit your refined taste.",
        heroBtn: "Shop Now",
        browseCollection: "Browse Collection",
        whyChooseUs: "Why Choose Our Store",
        shippingInfo: "Shipping Information",
        fullName: "Full Name",
        email: "Email",
        phone: "Mobile Number",
        address: "Address",
        city: "City",
        zip: "Postal Code",
        paymentMethod: "Payment Method",
        apply: "Apply",
        orderConfirmed: "Your order has been confirmed!",
        thankYou: "Thank you for shopping at Mayasah Style. Your order has been received and will be prepared for shipping as soon as possible. You will receive an email with order details and tracking once your order is shipped.",
        orderNumber: "Order Number:",
        orderDate: "Order Date:",
        totalAmount: "Total Amount:",
        shippingAddress: "Shipping Address:",
        trackingNumber: "Tracking Number:",
        continueShopping: "Continue Shopping",
        whyUs: "Why Us?",
        featuredProducts: "Featured Products",
        feature1Title: "High Quality",
        feature1Desc: "We use the best fabrics and embroidery for guaranteed quality.",
        feature2Title: "Fast Delivery",
        feature2Desc: "Quick and safe shipping to all regions of Saudi Arabia.",
        feature3Title: "24/7 Customer Support",
        feature3Desc: "Our support team is always here for you.",
        useMyLocation: "Use My Location",
        detectingLocation: "Detecting location...",
        locationDetected: "Location detected successfully!",
        cityDetectedNoStreet: "City detected but street address not found. Please enter your street name manually.",
        locationAccessDenied: "Location access denied. Please allow location access or enter manually.",
        locationUnavailable: "Location information unavailable.",
        locationTimeout: "Location request timed out.",
        couldNotGetAddress: "Could not get address from coordinates.",
        errorGettingAddress: "Error getting address: ",
        emailInvoice: "Email Invoice",
        chatWithBot: "Chat with Smart Assistant",
        mayasahAssistant: "Mayasah Smart Assistant",
        online: "Online Now",
        welcomeMessage: "Hello! I'm the Mayasah Smart Assistant. How can I help you today?",
        askProducts: "Available Products",
        askShipping: "Shipping Information",
        // Payment translations
        paymentInfo: "Payment Information",
        paymentInfoDesc: "Choose your preferred payment method",
        madaCard: "Mada Card",
        madaDesc: "Mada credit card or Mada direct",
        visaCard: "Visa / Mastercard",
        visaDesc: "International Visa and Mastercard",
        applePay: "Apple Pay",
        applePayDesc: "Pay with Apple Pay",
        stcPay: "STC Pay",
        stcPayDesc: "Pay with STC Pay app",
        cashOnDelivery: "Cash on Delivery",
        codDesc: "Pay cash when you receive your order",
        cardNumber: "Card Number",
        cardHolder: "Cardholder Name",
        expiryDate: "Expiry Date",
        cvv: "CVV",
        paymentSecurity: "All payments are protected and encrypted. We will not share your data with any third party.",
        payNow: "Pay Now",
        transactionId: "Transaction ID",
        askSizes: "Available Sizes",
        askContact: "Direct Contact",
        typeMessage: "Type your message here...",
        sendMessage: "Send us a Message",
        subject: "Subject",
        selectSubject: "Select Subject",
        generalInquiry: "General Inquiry",
        orderInquiry: "Order Inquiry",
        productInquiry: "Product Inquiry",
        complaint: "Complaint",
        suggestion: "Suggestion",
        typeYourMessage: "Type your message here...",
        contactWhatsapp: "Contact via WhatsApp",
        workingHours: "Working Hours",
        message: "Message",
        workingHoursText: "9am - 10pm",
        name: "Name",
        phoneOptional: "Phone Number (optional)",
        aboutUs: "About Us",
        aboutUsTitle: "Mayasah Style - A Journey of Elegance and Excellence",
        aboutUsIntro: "Welcome to Mayasah Style, your perfect destination for the latest and most beautiful women's abaya collections. We are a specialized store offering the best types of abayas that combine modern elegance with traditional authenticity.",
        aboutUsMission: "Since our establishment, our primary goal has been to provide unique pieces that reflect the beauty and elegance of Arab women. We carefully select every piece in our collection to ensure high quality and distinguished design.",
        aboutUsCollection: "We are proud to offer a wide range of abayas suitable for all occasions, from simple daily abayas to luxurious embroidered pieces for special occasions.",
        highQuality: "High Quality",
        highQualityDesc: "We select the best materials and fabrics to ensure comfort and elegance",
        passionForExcellence: "Passion for Excellence",
        passionForExcellenceDesc: "We work with passion to provide the best shopping experience for our valued customers",
        customerService: "Customer Service",
        customerServiceDesc: "A specialized support team always available to serve and assist you",
        ourMission: "Our Mission",
        missionStatement: "We strive to be the first choice for Arab women in the world of fashion, by providing abayas that combine elegance, quality, and comfort, while preserving authentic values and looking towards the future",
        termsConditions: "Terms & Conditions",
        lastUpdated: "Last Updated: January 2025",
        termsAcceptance: "Acceptance of Terms",
        termsAcceptanceText: "By using the Mayasah Style website, you agree to comply with these Terms and Conditions. If you do not agree to any part of these terms, please do not use our website.",
        useLicense: "Use License",
        useLicenseText: "A temporary license is granted to access materials on the Mayasah Style website for personal, non-commercial use only. This license does not include:",
        licenseRestriction1: "Modifying or copying materials",
        licenseRestriction2: "Using materials for commercial purposes",
        licenseRestriction3: "Attempting to reverse engineer any software on the Mayasah Style website",
        licenseRestriction4: "Removing any copyright or proprietary notices",
        productInformation: "Product Information",
        productInformationText: "We strive to ensure the accuracy of all product information, including descriptions, prices, and images. However, we do not guarantee that the information is accurate, complete, or up-to-date.",
        pricingAndPayment: "Pricing and Payment",
        pricingAndPaymentText: "All prices are in Saudi Riyals and include VAT. We reserve the right to change prices at any time without prior notice. All amounts must be paid in full at the time of order.",
        shippingAndDelivery: "Shipping and Delivery",
        shippingAndDeliveryText: "We deliver to all cities in Saudi Arabia. Expected delivery time is 3-5 business days. Delivery times may be delayed during special occasions or exceptional circumstances.",
        returnsAndRefunds: "Returns and Refunds",
        returnsAndRefundsText: "Products can be returned within 14 days of receipt, provided they are in excellent condition and unused. Shipping fees will be deducted from the refund amount.",
        privacyAndData: "Privacy and Data Protection",
        privacyAndDataText: "We are committed to protecting your privacy. Your personal information is collected and used in accordance with our Privacy Policy. By using our website, you agree to the collection and use of this information.",
        intellectualProperty: "Intellectual Property",
        intellectualPropertyText: "All content on the Mayasah Style website, including texts, images, and designs, is protected by copyright and intellectual property laws.",
        limitationOfLiability: "Limitation of Liability",
        limitationOfLiabilityText: "Mayasah Style will not be liable for any direct, indirect, incidental, or special damages arising from the use of our website or products.",
        governingLaw: "Governing Law",
        governingLawText: "These Terms and Conditions are governed by the laws of Saudi Arabia. Any disputes arising from these terms will be subject to the exclusive jurisdiction of Saudi Arabian courts.",
        changesToTerms: "Changes to Terms",
        changesToTermsText: "We reserve the right to modify these Terms and Conditions at any time. Changes will be posted on this page, and your continued use of the website after changes constitutes acceptance of the modifications.",
        contactInformation: "Contact Information",
        contactInformationText: "If you have any questions about these Terms and Conditions, please contact us via:",
        contactAddress: "Address: Jeddah, Saudi Arabia",
        privacyPolicy: "Privacy Policy",
        privacyCommitment: "Our Privacy Commitment",
        privacyCommitmentText: "At Mayasah Style, we are committed to protecting your privacy and personal data. This policy explains how we collect, use, and protect your information when you use our website.",
        informationWeCollect: "Information We Collect",
        informationWeCollectText: "We collect the following information:",
        personalInfo: "Personal information (name, email, phone number)",
        shippingInfo: "Shipping and address information",
        paymentInfo: "Payment information (we do not store card data)",
        orderHistory: "Order history and purchased products",
        websiteUsage: "Website usage and interaction data",
        howWeUseInfo: "How We Use Information",
        howWeUseInfoText: "We use your information for the following purposes:",
        usePurpose1: "Processing orders and completing sales",
        usePurpose2: "Communicating with you about your orders",
        usePurpose3: "Improving our services and user experience",
        usePurpose4: "Sending special offers and updates (with your consent)",
        usePurpose5: "Complying with applicable laws and regulations",
        informationSharing: "Information Sharing",
        informationSharingText: "We do not sell, rent, or share your personal information with third parties except in the following cases:",
        sharingCase1: "With shipping companies to deliver your orders",
        sharingCase2: "With payment service providers to process payments",
        sharingCase3: "When required by law",
        sharingCase4: "With your explicit consent",
        dataSecurity: "Data Security",
        dataSecurityText: "We take appropriate security measures to protect your personal information from unauthorized access, use, disclosure, alteration, or destruction. We use encryption and firewall technologies to protect your data.",
        cookies: "Cookies",
        cookiesText: "We use cookies to improve your experience on our website. These files help us remember your preferences and provide personalized content. You can manage cookie settings in your browser.",
        yourRights: "Your Rights",
        yourRightsText: "You have the right to:",
        right1: "Access your personal information",
        right2: "Correct any inaccurate information",
        right3: "Delete your personal information",
        right4: "Withdraw from marketing communications",
        right5: "File a complaint with relevant authorities",
        dataRetention: "Data Retention",
        dataRetentionText: "We retain your personal information as long as necessary to provide our services or comply with legal obligations. When this information is no longer needed, we securely delete it.",
        childrenPrivacy: "Children's Privacy",
        childrenPrivacyText: "We do not knowingly collect personal information from children under 13 years of age. If you are a parent or guardian and believe your child has provided us with personal information, please contact us immediately.",
        internationalTransfers: "International Transfers",
        internationalTransfersText: "Your information may be transferred to other countries for order processing or service provision. We ensure these transfers comply with applicable laws and appropriate security measures.",
        policyChanges: "Policy Changes",
        policyChangesText: "We may update this policy from time to time. We will notify you of any material changes via email or through a notice on our website. Please review this policy regularly.",
        contactUs: "Contact Us",
        contactUsText: "If you have any questions about this Privacy Policy or our data handling practices, please contact us via:"
    }
};

// Make translations available globally for updateProductDetailContent
window.translations = translations;

// --- Inject language buttons if missing ---
function ensureLanguageButtons() {
    document.querySelectorAll('.lang-switcher').forEach(switcher => {
        if (!switcher.querySelector('.lang-btn')) {
            switcher.innerHTML = `
                <button class="lang-btn" data-lang="ar">ุงูุนุฑุจูุฉ</button>
                <button class="lang-btn" data-lang="en">English</button>
            `;
        }
    });
}

function updateLangToggleActive(lang) {
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
    });
}

function setLanguage(lang) {
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    // Persist language under a few keys for backward compatibility across pages
    try {
        localStorage.setItem('language', lang);
        localStorage.setItem('siteLang', lang);
        localStorage.setItem('mayasah_language', lang);
    } catch (e) {
        // ignore storage errors
    }
    translatePage(lang);
    updateLangToggleActive(lang);
    updateAllProductPrices();
    populateProductCards(); // <-- ensure product cards update on language switch
    if (typeof renderCartItems === 'function') renderCartItems();
    if (typeof updateCartSummary === 'function') updateCartSummary();
    if (typeof updateCheckoutSummary === 'function') updateCheckoutSummary();
    if (typeof updateProductDetailContent === 'function') updateProductDetailContent();
    
    // Dispatch languageChanged event for other pages to listen to
    const languageChangedEvent = new CustomEvent('languageChanged', { detail: { language: lang } });
    document.dispatchEvent(languageChangedEvent);
}

function setupLanguageButtons() {
    ensureLanguageButtons();
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.onclick = function() {
            setLanguage(btn.getAttribute('data-lang'));
        };
    });
    // Set initial language: check all known storage keys for compatibility
    const lang = localStorage.getItem('language') || localStorage.getItem('siteLang') || localStorage.getItem('mayasah_language') || document.documentElement.lang || 'ar';
    setLanguage(lang);
}

// --- Product Detail Loader ---

// --- Product Detail Page Logic ---

// Add to Cart handler for product detail page
function addToCartFromDetail() {
    // Get product id from URL
    const urlParams = new URLSearchParams(window.location.search);
    const id = parseInt(urlParams.get('id'));
    let product = null;
    if (!isNaN(id)) {
        product = productsData.find(p => p.id === id);
    }
    if (!product) {
        product = productsData[0]; // fallback to first product
    }
    // Get selected size
    const sizeSelect = document.getElementById('size') || document.querySelector('.size-select');
    const selectedSize = sizeSelect ? sizeSelect.value : '';
    // Prevent adding to cart if no size is selected or default option is picked
    if (!selectedSize || selectedSize === '' || selectedSize === 'select' || selectedSize === 'ุงุฎุชุฑ ุงูููุงุณ' || selectedSize === 'Select Size') {
        showNotification(document.documentElement.lang === 'ar' ? 'ูุฑุฌู ุงุฎุชูุงุฑ ุงูููุงุณ ุฃููุงู' : 'Please select a size first');
        if (sizeSelect) sizeSelect.focus();
        return;
    }
    showLoadingOverlay();
    setTimeout(() => {
        // Default quantity is 1
        const quantity = 1;
        // Prepare cart item
        const cartItem = {
            id: product.id,
            key: product.key,
            name: product.key, // will be translated in cart
            image: product.images[0], // Use first image from images array
            price: product.price,
            size: selectedSize,
            quantity: quantity
        };
        // Get cart from localStorage
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        // Check if same product with same size already in cart
        const existingIdx = cart.findIndex(item => item.id === cartItem.id && item.size === cartItem.size);
        if (existingIdx !== -1) {
            cart[existingIdx].quantity += 1;
        } else {
            cart.push(cartItem);
        }
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
        hideLoadingOverlay();
        showNotification(document.documentElement.lang === 'ar' ? 'ุชูุช ุฅุถุงูุฉ ุงูููุชุฌ ุฅูู ุงูุณูุฉ' : 'Product added to cart');
        
        // Track add to cart event if analytics consent given
        if (window.pdplCookieManager && window.pdplCookieManager.hasConsent('analytics')) {
            if (window.trackAddToCart) {
                window.trackAddToCart(product.id, product.key, product.price, quantity);
            }
            if (window.trackFacebookAddToCart) {
                window.trackFacebookAddToCart(product.id, product.key, product.price, quantity);
            }
        }
    }, 600); // Simulate loading for 600ms
}
function updateProductDetailContent(retry) {
    // Only attempt to run this updater on the product detail page.
    // This prevents the function from repeatedly retrying on other pages
    // (which was causing many console warnings like "No .product-detail-info found, retry: N").
    if (!window.location.pathname.endsWith('product-detail.html') && !document.body.classList.contains('product-detail-page')) {
        // Early exit when not on product detail to avoid noisy retries.
        return;
    }
    console.log('updateProductDetailContent called', { retry });
    // Helper: show error on page
    function showDetailError(msg) {
        console.error('Product Detail Error:', msg);
        let err = document.getElementById('product-detail-error');
        if (!err) {
            err = document.createElement('div');
            err.id = 'product-detail-error';
            err.style.position = 'fixed';
            err.style.top = '10px';
            err.style.left = '50%';
            err.style.transform = 'translateX(-50%)';
            err.style.background = '#c00';
            err.style.color = '#fff';
            err.style.padding = '10px 20px';
            err.style.zIndex = 99999;
            err.style.fontSize = '1.2em';
            err.style.borderRadius = '6px';
            document.body.appendChild(err);
        }
        err.textContent = 'Product Detail Error: ' + msg;
        setTimeout(() => { if (err) err.remove(); }, 6000);
    }
    // Only run on product detail page
    const info = document.querySelector('.product-detail-info');
    if (!info) {
        // If still on the product-detail page, allow a few retries while the DOM finishes
        // loading or other scripts insert the target element. Use a small number of retries
        // and a slightly larger delay to avoid flooding the console.
        console.warn('No .product-detail-info found, retry:', retry);
        const count = typeof retry === 'number' ? retry : 0;
        if (count < 8) {
            setTimeout(() => updateProductDetailContent(count + 1), 150);
        } else {
            // Give up after a few attempts to be friendly to console logs.
            console.error('updateProductDetailContent: giving up after multiple retries.');
        }
        return;
    }
    // Defensive: ensure productsData and translations are loaded
    if (!window.productsData || !Array.isArray(productsData) || productsData.length === 0) {
        console.warn('productsData not loaded or empty');
        return;
    }
    if (!window.translations) {
        console.warn('translations not loaded');
        return;
    }

    const urlParams = new URLSearchParams(window.location.search);
    const id = parseInt(urlParams.get('id'));
    console.log('Parsed product id:', id);
    let product = null;
    if (!isNaN(id)) {
        product = productsData.find(p => p.id === id);
    }
    if (!product) {
        showDetailError('No product found for id=' + id + '. Showing default product.');
        product = productsData[0];
    }
    console.log('Product to display:', product);
    const lang = document.documentElement.lang || 'ar';
    const langObj = translations[lang] || translations['ar'];

    // Set image
    const img = document.getElementById('product-image') || document.querySelector('.product-image img');
    if (img) {
        img.src = product.images[0]; // Use first image from images array
        img.alt = langObj[product.key] || product.key || '';
        img.style.display = '';
    } else {
        showDetailError('Missing #product-image or .product-image img');
    }

    // Set product title safely
    const title = document.getElementById('product-title') || document.querySelector('.product-title');
    if (title) {
        title.textContent = langObj[product.key] || '';
        setGoldenEmbroideryTitleClass(product, lang, title);
    } else {
        showDetailError('Missing .product-title or #product-title');
    }
// Helper to set targeted class for golden embroidery product title
function setGoldenEmbroideryTitleClass(product, lang, titleEl) {
    if (!titleEl || !product) return;
    if (lang === 'en' && product.key === 'product2') {
        titleEl.classList.add('product-title-golden-embroidery-en');
    } else {
        titleEl.classList.remove('product-title-golden-embroidery-en');
    }
}
    // Ensure targeted product title class is updated after language switch
    const urlParams_gp = new URLSearchParams(window.location.search);
    const id_gp = parseInt(urlParams_gp.get('id'));
    const product_gp = window.productsData ? window.productsData.find(p => p.id === id_gp) : null;
    const titleEl_gp = document.getElementById('product-title');
    setGoldenEmbroideryTitleClass(product_gp, lang, titleEl_gp);

    // Set description
    const desc = document.getElementById('product-description') || document.querySelector('.product-description');
    if (desc) {
        desc.textContent = lang === 'ar' ? product.desc_ar : product.desc_en;
    } else {
        showDetailError('Missing #product-description or .product-description');
    }

    // Set prices and currency
    const currentPrice = document.querySelector('.current-price') || document.getElementById('current-price');
    if (currentPrice) {
        currentPrice.innerHTML = product.price.toFixed(2) + getCurrencyHTML();
        currentPrice.setAttribute('data-price', product.price);
        currentPrice.style.display = '';
    } else {
        showDetailError('Missing .current-price or #current-price');
    }

    // Try both id and class for original price
    let originalPrice = document.getElementById('original-price') || document.querySelector('.original-price');
    if (originalPrice) {
        if (product.original && product.original > product.price) {
            originalPrice.innerHTML = product.original.toFixed(2) + getCurrencyHTML();
            originalPrice.style.display = '';
            originalPrice.setAttribute('data-price', product.original);
        } else {
            originalPrice.style.display = 'none';
        }
    } // original price is optional

    // Set discount badge
    const discountBadge = document.getElementById('discount-badge') || document.querySelector('.discount');
    if (discountBadge) {
        if (product.discount) {
            // If discount is a translation key (like "new"), use translation
            const lang = document.documentElement.lang || 'ar';
            const langObj = translations[lang] || translations['ar'];
            if (langObj[product.discount]) {
                discountBadge.textContent = langObj[product.discount];
            } else {
                discountBadge.textContent = product.discount;
            }
            discountBadge.style.display = '';
        } else {
            discountBadge.style.display = 'none';
        }
    } // discount badge is optional

    // Ensure size label, select option, and add-to-cart button are translated and visible
    const sizeLabel = document.querySelector('label[for="size"][data-translate="size"]') || document.querySelector('label[for="size"]');
    if (sizeLabel && langObj['size']) {
        sizeLabel.textContent = langObj['size'];
    } else if (!sizeLabel) {
        showDetailError('Missing label[for="size"]');
    }
    const sizeSelect = document.getElementById('size') || document.querySelector('.size-select');
    if (sizeSelect) {
        const selectOption = sizeSelect.querySelector('option[data-translate="selectSize"]') || sizeSelect.querySelector('option');
        if (selectOption && langObj['selectSize']) {
            selectOption.textContent = langObj['selectSize'];
        }
        sizeSelect.style.display = '';
    } else {
        showDetailError('Missing #size or .size-select');
    }
    let addToCartBtn = document.querySelector('.add-to-cart.full-width-btn') || document.querySelector('.add-to-cart');
    if (addToCartBtn) {
        const addToCartText = addToCartBtn.querySelector('.add-to-cart-text[data-translate="addToCart"]') || addToCartBtn.querySelector('.add-to-cart-text') || addToCartBtn;
        if (addToCartText && langObj['addToCart']) {
            addToCartText.textContent = langObj['addToCart'];
        }
        addToCartBtn.style.display = '';
        // Attach Add to Cart handler
        addToCartBtn.onclick = addToCartFromDetail;
    } else {
        showDetailError('Missing .add-to-cart button');
    }
    // Defensive: always show info section
    if (info) info.style.display = '';
}

// --- Populate Product Cards ---
function populateProductCards() {
    // For each product card, always update the image, info, and prices
    document.querySelectorAll('.product-card').forEach((card, idx) => {
        // Get product id from link or fallback to index
        let id = idx + 1;
        const link = card.querySelector('a.product-link');
        if (link) {
            const url = new URL(link.href, window.location.origin);
            const paramId = url.searchParams.get('id');
            if (paramId) id = parseInt(paramId);
        }
        const product = productsData.find(p => p.id === id);
        if (!product) return;
        // Always fill image
        const imgDiv = card.querySelector('.product-image');
        if (imgDiv) {
            imgDiv.innerHTML = `<img src="${product.image}" alt="">`;
        }
        // Always fill info (add name/desc)
        const infoDiv = card.querySelector('.product-info');
        if (infoDiv) {
            const lang = document.documentElement.lang || 'ar';
            const name = (product.key && translations[lang] && translations[lang][product.key]) ? translations[lang][product.key] : (lang === 'ar' ? product.desc_ar : product.desc_en);
            infoDiv.innerHTML = `<span>${name || product.key || ''}</span>`;
        }
        // Always fill price spans
        const currentPrice = card.querySelector('.current-price');
        if (currentPrice) {
            currentPrice.innerHTML = product.price.toFixed(2) + getCurrencyHTML();
            currentPrice.setAttribute('data-price', product.price);
            currentPrice.style.display = '';
        }
        const originalPrice = card.querySelector('.original-price');
        if (originalPrice) {
            if (product.original && product.original > product.price) {
                originalPrice.innerHTML = product.original.toFixed(2) + getCurrencyHTML();
                originalPrice.setAttribute('data-price', product.original);
                originalPrice.style.display = '';
            } else {
                originalPrice.style.display = 'none';
            }
        }
        const discount = card.querySelector('.discount');
        if (discount) {
            if (product.discount) {
                discount.textContent = product.discount;
                discount.style.display = '';
            } else {
                discount.style.display = 'none';
            }
        }
    });
}

// --- On DOMContentLoaded, initialize everything ---

function fullAppInit() {
    // Inject language buttons if missing and set up event handlers
    ensureLanguageButtons();
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.onclick = function() {
            setLanguage(btn.getAttribute('data-lang'));
        };
    });
    // Set initial language from localStorage or default
    const lang = localStorage.getItem('language') || document.documentElement.lang || 'ar';
    setLanguage(lang);
    
    // Robust loader for product detail page
    document.addEventListener('DOMContentLoaded', function() {
        // Only run on product-detail.html
        if (window.location.pathname.endsWith('product-detail.html')) {
            // Wait until productsData and translations are loaded
            function tryLoadDetail(retry) {
                if (window.productsData && Array.isArray(productsData) && productsData.length > 0 && window.translations) {
                    updateProductDetailContent();
                } else if ((retry || 0) < 20) {
                    setTimeout(() => tryLoadDetail((retry || 0) + 1), 100);
                } else {
                    // Show error if data never loads
                    if (typeof showDetailError === 'function') {
                        showDetailError('productsData or translations not loaded after waiting.');
                    } else {
                        alert('productsData or translations not loaded.');
                    }
                }
            }
            tryLoadDetail(0);
        }
    });
}

document.addEventListener('DOMContentLoaded', fullAppInit);


// --- Cart Count Updater ---
function updateCartCount() {
    // Defensive: only update if cart icon exists
    const cartCount = document.querySelector('.cart-count');
    if (!cartCount) return;
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    cartCount.textContent = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
}

// --- Loading overlay functions ---
function showLoadingOverlay() {
    let overlay = document.getElementById('loading-overlay');
    if (!overlay) {
        overlay = document.createElement('div');
        overlay.id = 'loading-overlay';
        overlay.style.position = 'fixed';
        overlay.style.top = 0;
        overlay.style.left = 0;
        overlay.style.width = '100vw';
        overlay.style.height = '100vh';
        overlay.style.background = 'rgba(255,255,255,0.7)';
        overlay.style.display = 'flex';
        overlay.style.alignItems = 'center';
        overlay.style.justifyContent = 'center';
        overlay.style.zIndex = 9999;
        overlay.innerHTML = '<div class="spinner" style="border:6px solid #f3f3f3;border-top:6px solid var(--deep-rose);border-radius:50%;width:48px;height:48px;animation:spin 1s linear infinite;"></div>';
        document.body.appendChild(overlay);
        const style = document.createElement('style');
        style.textContent = '@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}';
        document.head.appendChild(style);
    } else {
        overlay.style.display = 'flex';
    }
}
function hideLoadingOverlay() {
    const overlay = document.getElementById('loading-overlay');
    if (overlay) overlay.style.display = 'none';
}

function showNotification(message) {
    const notification = document.createElement('div');
    notification.textContent = message;
    notification.style.position = 'fixed';
    notification.style.bottom = '20px';
    notification.style.left = '50%';
    notification.style.transform = 'translateX(-50%)';
    notification.style.backgroundColor = 'var(--deep-rose)';
    notification.style.color = 'white';
    notification.style.padding = '10px 20px';
    notification.style.borderRadius = '5px';
    notification.style.zIndex = '1000';
    notification.style.boxShadow = '0 4px 6px rgba(0,0,0,0.1)';
    notification.style.transition = 'all 0.3s ease';
    document.body.appendChild(notification);
    setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 2000);
}

updateCartCount();

const vatRate = 0.15;
const freeShippingThreshold = 300;
const promoCodes = {
    'WELCOME10': 0.10,
    'SAVE15': 0.15,
    'FREESHIP': 'freeship'
};
const saudiCitiesAr = [
    "ุงูุฑูุงุถ", "ุฌุฏุฉ", "ููุฉ ุงูููุฑูุฉ", "ุงููุฏููุฉ ุงููููุฑุฉ", "ุงูุฏูุงู",
    "ุงูุทุงุฆู", "ุชุจูู", "ุจุฑูุฏุฉ", "ุฎููุณ ูุดูุท", "ุงููููู",
    "ุญูุฑ ุงูุจุงุทู", "ุงูุฌุจูู", "ุงูุธูุฑุงู", "ุฃุจูุง", "ูุฌุฑุงู"
];
const saudiCitiesEn = [
    "Riyadh", "Jeddah", "Makkah", "Madinah", "Dammam",
    "Taif", "Tabuk", "Buraidah", "Khamis Mushait", "Hofuf",
    "Hafar Al-Batin", "Jubail", "Dhahran", "Abha", "Najran"
];

function renderCartItems() {
    cartItems = JSON.parse(localStorage.getItem('cart')) || [];
    const cartContainer = document.querySelector('.cart-items');
    if (!cartContainer) return;
    cartContainer.innerHTML = '';

    if (!cartItems.length) {
        cartContainer.innerHTML = `<p data-translate="emptyCart">${translations[document.documentElement.lang].emptyCart}</p>`;
        updateCheckoutButton();
        return;
    }

    cartItems.forEach((item, idx) => {
        if (typeof item.price !== 'number' || isNaN(item.price)) return;
        const removeText = document.documentElement.lang === 'ar' ? 'ุฅุฒุงูุฉ' : 'Remove';
        // --- Use translated name for cart item ---
        const lang = document.documentElement.lang || 'ar';
        const productData = productsData.find(p => p.id === item.id);
        // Always use translation key if present, fallback to item.name
        const name = (item.key && translations[lang][item.key])
            ? translations[lang][item.key]
            : (productData && productData.key && translations[lang][productData.key])
                ? translations[lang][productData.key]
                : (item.name || (lang === 'ar' ? (productData && productData.name_ar) : (productData && productData.name_en)) || '');
        // --- Add size dropdown ---
        const sizes = ['S','M','L','XL'];
        const sizeOptions = sizes.map(sz => `<option value="${sz}"${item.size===sz?' selected':''}>${sz}</option>`).join('');
        const itemDiv = document.createElement('div');
        itemDiv.className = 'cart-item';
        // Ensure image path is correct
        const imagePath = item.image || (productsData.find(p => p.id === item.id)?.images?.[0]) || 'images/abaya1.jpg';
        
        itemDiv.innerHTML = `
            <button class="remove-item-btn" data-idx="${idx}">&#10006;</button>
            <div class="cart-item-image">
                <img src="${imagePath}" alt="${name}" onerror="this.src='images/abaya1.jpg'">
            </div>
            <div class="cart-item-details">
                <h4 class="cart-item-title">${name}</h4>
                <div class="cart-item-info">
                    <div class="cart-item-price">
                        <span class="price-label">${document.documentElement.lang === 'en' ? 'Price' : 'ุงูุณุนุฑ'}:</span>
                        <span class="price-value">${item.price.toFixed(2)}${getCurrencyHTML()}</span>
                    </div>
                    <div class="cart-item-size">
                        <span class="size-label">${document.documentElement.lang === 'en' ? 'Size' : 'ุงูููุงุณ'}:</span>
                        <select class="cart-size-select" data-idx="${idx}">${sizeOptions}</select>
                    </div>
                    <div class="cart-item-quantity">
                        <span class="quantity-label">${document.documentElement.lang === 'en' ? 'Quantity' : 'ุงููููุฉ'}:</span>
                        <div class="quantity-controls">
                            <button class="qty-btn decrease" data-idx="${idx}">-</button>
                            <span class="quantity-display">${item.quantity}</span>
                            <button class="qty-btn increase" data-idx="${idx}">+</button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        cartContainer.appendChild(itemDiv);
    });

    cartContainer.querySelectorAll('.qty-btn.increase').forEach(btn => {
        btn.addEventListener('click', function() {
            cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const idx = parseInt(this.dataset.idx);
            cartItems[idx].quantity++;
            localStorage.setItem('cart', JSON.stringify(cartItems));
            renderCartItems();
            updateCartSummary();
            updateCartCount();
        });
    });
    cartContainer.querySelectorAll('.qty-btn.decrease').forEach(btn => {
        btn.addEventListener('click', function() {
            cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const idx = parseInt(this.dataset.idx);
            if (cartItems[idx].quantity > 1) {
                cartItems[idx].quantity--;
            } else {
                cartItems.splice(idx, 1);
            }
            localStorage.setItem('cart', JSON.stringify(cartItems));
            renderCartItems();
            updateCartSummary();
            updateCartCount();
        });
    });
    cartContainer.querySelectorAll('.remove-item-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const idx = parseInt(this.dataset.idx);
            cartItems.splice(idx, 1);
            localStorage.setItem('cart', JSON.stringify(cartItems));
            renderCartItems();
            updateCartSummary();
            updateCartCount();
        });
    });
    // --- Handle size change in cart ---
    cartContainer.querySelectorAll('.cart-size-select').forEach(sel => {
        sel.addEventListener('change', function() {
            cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const idx = parseInt(this.dataset.idx);
            cartItems[idx].size = this.value;
            localStorage.setItem('cart', JSON.stringify(cartItems));
            renderCartItems();
            updateCartSummary();
            updateCartCount();
        });
    });
    updateCheckoutButton();
}

function updateCartSummary() {
    const subtotal = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const vat = subtotal * vatRate;
    const shipping = cartItems.length === 0 ? 0 : (subtotal >= freeShippingThreshold ? 0 : 20);

    const promoCodeInput = document.querySelector('#promo-code');
    let promoCode = promoCodeInput ? promoCodeInput.value.trim().toUpperCase() : '';
    let promoDiscount = 0;
    let promoShippingDiscount = false;

    if (promoCode && promoCodes[promoCode]) {
        if (typeof promoCodes[promoCode] === 'number') {
            promoDiscount = subtotal * promoCodes[promoCode];
        } else if (promoCodes[promoCode] === 'freeship') {
            promoShippingDiscount = true;
        }
    }

    const total = subtotal + vat + (promoShippingDiscount ? 0 : shipping) - promoDiscount;

    // --- FIX: Only update if element exists ---
    const subtotalEl = document.querySelector('.subtotal-amount');
    if (subtotalEl) subtotalEl.innerHTML = subtotal.toFixed(2) + getCurrencyHTML();

    const vatEl = document.querySelector('.vat-amount');
    if (vatEl) vatEl.innerHTML = vat.toFixed(2) + getCurrencyHTML();

    const shippingEl = document.querySelector('.shipping-amount');
    if (shippingEl) shippingEl.innerHTML = (promoShippingDiscount ? 0 : shipping).toFixed(2) + getCurrencyHTML();

    const totalEl = document.querySelector('.total-amount');
    if (totalEl) totalEl.innerHTML = total.toFixed(2) + getCurrencyHTML();

    const freeShippingMsg = document.querySelector('.free-shipping-msg');
    if (freeShippingMsg) {
        if (shipping === 0 || promoShippingDiscount) {
            freeShippingMsg.textContent = document.documentElement.lang === 'en' 
                ? 'Congratulations! Free shipping for this order!' 
                : '!ูุจุฑูู! ุงูุดุญู ูุฌุงูู ููุฐุง ุงูุทูุจ';
            freeShippingMsg.style.color = '#28a745';
        } else {
            const needed = freeShippingThreshold - subtotal;
            if (needed > 0) {
                if (document.documentElement.lang === 'en') {
                    freeShippingMsg.textContent = `Add ${needed.toFixed(2)} SAR more to get free shipping`;
                } else {
                    freeShippingMsg.innerHTML = `ุฃุถู ููุชุฌุงุช ุจูููุฉ ${needed.toFixed(2)}${getCurrencyHTML()} ุฃุฎุฑู ูุชุญุตู ุนูู ุดุญู ูุฌุงูู`;
                }
                freeShippingMsg.style.color = 'var(--muted-red)';
            }
        }
    }

    localStorage.setItem('shippingCost', (promoShippingDiscount ? 0 : shipping).toFixed(2));
}

function updateCart() {
    localStorage.setItem('cart', JSON.stringify(cartItems));
    renderCartItems();
    updateCartSummary();
    updateCartCount();
}

function updateCheckoutButton() {
    const checkoutBtn = document.querySelector('.checkout-btn');
    if (checkoutBtn) {
        if (cartItems.length === 0) {
            checkoutBtn.classList.add('disabled');
            checkoutBtn.setAttribute('aria-disabled', 'true');
            checkoutBtn.onclick = function(e) {
                e.preventDefault();
                showNotification(document.documentElement.lang === 'en'
                    ? 'Your cart is empty, add products first'
                    : 'ุณูุฉ ุงูุชุณูู ูุงุฑุบุฉุ ุฃุถู ููุชุฌุงุช ุฃููุงู');
            };
        } else {
            checkoutBtn.classList.remove('disabled');
            checkoutBtn.removeAttribute('aria-disabled');
            checkoutBtn.onclick = null;
        }
    }
}

function updateCheckoutSummary() {
    const lang = document.documentElement.lang;
    const items = JSON.parse(localStorage.getItem('cart')) || [];
    const subtotal = items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const vat = +(subtotal * 0.15).toFixed(2);
    const shipping = parseFloat(localStorage.getItem('shippingCost')) || 0;
    const total = +(subtotal + vat + shipping).toFixed(2);
    const currency = getCurrency();

    const subtotalEl = document.querySelector('.subtotal-amount');
    if (subtotalEl) subtotalEl.innerHTML = subtotal.toFixed(2) + getCurrencyHTML();
    const vatEl = document.querySelector('.vat-amount');
    if (vatEl) vatEl.innerHTML = vat.toFixed(2) + getCurrencyHTML();
    const shippingEl = document.querySelector('.shipping-amount');
    if (shippingEl) shippingEl.innerHTML = shipping.toFixed(2) + getCurrencyHTML();
    const totalEl = document.querySelector('.total-amount');
    if (totalEl) totalEl.innerHTML = total.toFixed(2) + getCurrencyHTML();
}

function populateCities(lang) {
    const citySelect = document.getElementById('city');
    if (!citySelect) return;
    citySelect.innerHTML = '<option value="">' + (lang === 'en' ? 'Select City' : 'ุงุฎุชุฑ ุงููุฏููุฉ') + '</option>';
    const cities = lang === 'en' ? saudiCitiesEn : saudiCitiesAr;
    cities.forEach(city => {
        const option = document.createElement('option');
        option.value = city;
        option.textContent = city;
        citySelect.appendChild(option);
    });
}

function getCurrency() {
    return document.documentElement.lang === 'en' ? 'SAR' : '๏ทผ';
}

function getCurrencyHTML() {
    if (document.documentElement.lang === 'ar') {
        // Use new Saudi Riyal symbol (ุฑ.ุณ)
        return ' <span style="font-family: Arial, sans-serif; font-size: 1.2em; vertical-align: middle;">ุฑ.ุณ</span>';
    } else {
        return ' SAR';
    }
}

function updateAllProductPrices() {
    document.querySelectorAll('.current-price').forEach(el => {
        const price = parseFloat(el.getAttribute('data-price'));
        if (!isNaN(price)) {
            el.innerHTML = price.toFixed(2) + getCurrencyHTML();
        }
    });
    document.querySelectorAll('.original-price').forEach(el => {
        const price = parseFloat(el.getAttribute('data-price'));
        if (!isNaN(price)) {
            el.innerHTML = price.toFixed(2) + getCurrencyHTML();
        }
    });
}

// CSS Styles for cart item layout
const style = document.createElement('style');
style.textContent = `
.cart-item {
    position: relative;
    padding-top: 32px;
}
.remove-item-btn {
    z-index: 2;
}
`;
document.head.appendChild(style);

// Reminder: For cart icon, ensure this is in your <head>:
// <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
// And you have internet connection, or use a local copy for offline use.

// Expose required variables and functions globally for checkout.js
window.saudiCitiesAr = saudiCitiesAr;
window.saudiCitiesEn = saudiCitiesEn;
window.getCurrencyHTML = getCurrencyHTML;
window.populateCities = populateCities;

// End of file